<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>달다구리스</title>
    <!-- bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
          rel="stylesheet"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
          crossorigin="anonymous">
    <style>
        .card-main{
            margin-top: 88px;
            padding-left: 186px;
            padding-right: 186px;
        }
        .dropdown-menu {
            display: none;
            position: absolute;
            background-color: #f9f9f9;
            border: 1px solid #ddd;
        }
        .dropdown-menu a:hover {
            background-color: #f1f1f1;
        }
        .show {
            display: block;
        }
        .card-profile{
            margin-top: 88px; padding-left: 50px;
        }
        .card-shadow {
            margin-top: 10px;
        }
        #card1 {
            width: 90%;
            margin-top: -850px; margin-left:250px; margin-left:60px; padding-left: 50px;
        }
        .container {
            position: relative;
        }
        .fixed-bottom-right {
            position: absolute;
            bottom: 140px;
            right: 30px;
        }

    </style>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</head>
<body>

<!-- 상단메뉴 -->
<div id="header">
    <div th:replace="page_header/header.html :: header-head"></div>
    <div th:replace="page_header/header.html :: header-body"></div>
</div>

<!-- 유저프로필 라인 -->
<div id="profile">
    <div th:replace="page_profile/profile.html :: profile-head"></div>
    <div th:replace="page_profile/profile.html :: profile-body"></div>
</div>

<!-- 정보수정 -->
<div class="container mt-2">
    <div class="row">
        <div class="col-sm-3"></div>

        <div class="col-sm-6">
            <div class="card-shadow" id="card1">
                <h3>회원정보 수정</h3>
                <hr/>
                <div class="card-body">
                    <form action="/user/user_modify" th:object="${modifyUserBean}" method="get">
                        <div class="form-group">
                            <label for="user_name"> # 이름</label>
                            <input type="text" id="user_name" name="user_name" th:field="*{user_name}"
                                   class="form-control" disabled="disabled"/>
                        </div>

                        <div class="form-group">
                            <label for="user_id"> # 아이디</label>
                            <input type="text" id="user_id" name="user_id" th:field="*{user_id}" class="form-control"
                                   disabled="disabled"/>
                        </div>
                        <div class="form-group">
                            <label for="user_birth"> # 생년월일</label>
                            <input type="text" id="user_birth" name="user_birth" th:field="*{user_birth}"
                                   class="form-control" disabled="disabled"/>
                        </div>
                    </form>

                    <form action="/user/update_password" th:object="${modifyUserBean}" method="post">
                        <div class="form-group">
                            <label for="user_pw"> # 비밀번호</label>
                            <input type="text" name="user_pw" th:field="*{user_pw}"
                                   class="form-control"
                                   disabled="disabled"/>
                            <p class="d-inline-flex gap-1">
                                <button class="btn btn-outline-info" type="button" data-bs-toggle="collapse"
                                        data-bs-target="#collapseExample_pw" aria-expanded="false"
                                        aria-controls="collapseExample">
                                    비밀번호 수정
                                </button>
                            </p>
                            <div class="collapse" id="collapseExample_pw">
                                <div class="card card-body">
                                    <!-- 비밀번호 수정 -->
                                    <div class="card-shadow" id="card_pw1">
                                        <div class="card-body">
                                            <h5 class="card-title">비밀번호 수정</h5>
                                            <div class="form-group">
                                                <label for="user_pw">새 비밀번호</label>
                                                <input type="password" id="user_pw" name="user_pw"
                                                       class="form-control"
                                                       required/>
                                            </div>
                                            <div class="form-group">
                                                <label for="user_pw2">비밀번호 확인</label>
                                                <input type="password" id="user_pw2" name="user_pw2"
                                                       class="form-control" required/>
                                            </div>
                                            <button type="submit" class="btn btn-outline-success">비밀번호 변경
                                            </button>

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>

                    <form action="/user/update_email" th:object="${modifyUserBean}" method="post">
                        <div class="form-group">
                            <label for="current_user_email"> # 이메일</label>
                            <input type="email" id="current_user_email" th:field="*{user_email}" name="user_email"
                                   class="form-control" disabled="disabled"/>
                            <p class="d-inline-flex gap-1">
                                <button class="btn btn-outline-info" type="button" data-bs-toggle="collapse"
                                        data-bs-target="#collapseExample_email" aria-expanded="false"
                                        aria-controls="collapseExample">
                                    이메일 수정
                                </button>
                            </p>
                            <div class="collapse" id="collapseExample_email">
                                <div class="card card-body">
                                    <div class="card-shadow" id="card2" style="margin-top: 20px;">
                                        <div class="card-body">
                                            <h5 class="card-title">이메일 수정</h5>

                                            <div class="form-group">
                                                <label for="new_user_email">새 이메일</label>
                                                <input type="email" id="new_user_email" name="user_email"
                                                       class="form-control" required/>
                                            </div>
                                            <button type="submit" class="btn btn-outline-success">이메일 변경
                                            </button>

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                    <!-- 이메일 수정 -->

                    <form action="/user/update_phone" th:object="${modifyUserBean}" method="post">
                        <div class="form-group">
                            <label for="current_user_phone"> # 연락처</label>
                            <input type="tel" id="current_user_phone" name="user_phone" th:field="*{user_phone}"
                                   class="form-control" disabled="disabled"/>
                            <p class="d-inline-flex gap-1">
                                <button class="btn btn-outline-info" type="button" data-bs-toggle="collapse"
                                        data-bs-target="#collapseExample_phone" aria-expanded="false"
                                        aria-controls="collapseExample">
                                    연락처 수정
                                </button>
                            </p>
                            <div class="collapse" id="collapseExample_phone">
                                <div class="card card-body">
                                    <!-- 연락처 수정 -->
                                    <div class="card-shadow" id="card3" style="margin-top: 20px;">
                                        <div class="card-body">
                                            <h5 class="card-title">연락처 수정</h5>

                                            <div class="form-group">
                                                <label for="new_user_phone">새 연락처</label>
                                                <input type="tel" id="new_user_phone" name="user_phone"
                                                       class="form-control"
                                                       required/>
                                            </div>
                                            <button type="submit" class="btn btn-outline-success">연락처 변경
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>

                    <div class="form-group">
                        <div class="d-flex justify-content-end">
                            <button type="button" class="btn btn-outline-primary me-2" onclick="history.back()">
                                뒤로가기
                            </button> &ensp;
                            <button type="button" class="btn btn-outline-danger" onclick="deSignUp()">
                                회원탈퇴
                            </button> &ensp;
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-3"></div>
    </div>
</div>
<hr/>

<script th:inline="javascript">
    function deSignUp(){
        let result = confirm('회원탈퇴를 진행하시겠습니까?');
        if(result){
            $.ajax({
                url: '/rest/deSignUp',
                type: 'POST',
                data:{
                    user_idx: [[${user_idx}]]
                },
                success: function(data){
                    alert('회원탈퇴를 완료했습니다.')
                    location.href = '/';
                }
            });
        }else{
            alert('회원탈퇴를 취소했습니다.')
        }
    }
</script>

<!-- 하단 -->
<div id="footer">
    <div th:replace="page_footer/footer.html :: footer-head"></div>
    <div th:replace="page_footer/footer.html :: footer-body"></div>

<!-- bootstrap -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
    crossorigin="anonymous"></script>
</div>
</body>
</html>
